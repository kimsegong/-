<!DOCTYPE html>
<html lang="en">
<head th:replace="~{layout/header::head('일정작성')}"></head>
<style>
    .plan-box {
        border: 1px solid #FF8A08; /* 회색 테두리 */
        padding: 10px; /* 내부 여백 */
        margin-bottom: 15px; /* 박스 간 마진 */
        background-color: #ECCA9C; /* 배경 색상 */
        border-radius: 5px; /* 모서리 둥글게 */
        box-shadow: 0 2px 5px rgba(0,0,0,0.1); /* 그림자 효과 */
    }
    .font {
        font-size: 18px;
        font-weight: normal;
        color: #1A4D2E;
    }
    #gi{
        margin-bottom: 20px;
    }
    .label {
        margin-right: 10px; /* 라벨과 값 사이에 10px의 마진 추가 */
        font-weight: bold; /* 라벨 텍스트를 굵게 */
    }

    .value {
        display: inline-block; /* 값이 라벨과 같은 줄에 표시 */
    }

</style>

<body>

<div th:replace="~{layout/header::header}"></div>
<div class="container text-center">  <!-- 그리드 시작 -->
    <div class="row">
        <div class="col-1">
        </div>
        <div class="col-10" >
            <div id="gi">
            <h2>일정 모아보기</h2>
            </div>
            <div>
                <input type="hidden" id="userNo" th:value="${session.user.userNo}">
                <div id="plan_list"></div>
            </div>
        </div>
        <div class="col-1">
        </div>
    </div>
</div>

<script th:inline="javascript">

    function formatDateTime(dateTimeString) {
        if (!dateTimeString) return '';
        const date = new Date(dateTimeString);
        return new Intl.DateTimeFormat('ko-KR', {
            year: 'numeric',
            month: 'long',
            day: 'numeric',
            hour: '2-digit',
            minute: '2-digit',
            second: '2-digit'
        }).format(date);
    }

    var page = 1;
    var totalPage = 0;
    var userNo = document.getElementById('userNo').value;
    const fnGetPlanList = () => {
        $.ajax({
            type: 'get',
            url: '/plan/getPlanList.do',
            data: {
                page: page,
                userNo: userNo
            },
            dataType: 'json',
            success: (resData) => {
                totalPage = resData.totalPage;
                if (resData.planList != null && resData.planList.length > 0) {
                    $.each(resData.planList, (i, plan) => {
                        console.log("응답 데이터:", resData);
                        let str = '<div class="plan-box">';
                        str += '<div class="font">시작날짜/시간 <span class="label"></span><span class="value">' + formatDateTime(plan.startAt) + '</span></div>';
                        str += '<div class="font">종료날짜/시간 <span class="label"></span><span class="value">' + formatDateTime(plan.endAt) + '</span></div>';
                        str += '<div class="font">첫번째일정 <span class="label"></span><span class="value">' + (plan.firstPlan || '') + '</span></div>';
                        str += '<div><span>' + (plan.firstComment || '') + '</span></div>';
                        str += '<div class="font">두번째일정 <span class="label"></span><span class="value">' + (plan.secondPlan || '') + '</span></div>';
                        str += '<div><span>' + (plan.secondComment || '') + '</span></div>';
                        str += '<div class="font">세번째일정 <span class="label"></span><span class="value">' + (plan.thirdPlan || '') + '</span></div>';
                        str += '<div><span>' + (plan.thirdComment || '') + '</span></div>';
                        str += '</div>';
                        $('#plan_list').append(str);
                    });
                } else {
                    $('#plan_list').append('<p>No plans found.</p>');
                }
            },
            error: (error) => {
                console.error('Ajax 요청 에러:', error);
            }
        });

    };

    fnGetPlanList();

</script>



<div th:replace="~{layout/footer::footer}"></div>
</body>
</html>