<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/fullcalendar@5.10.1/main.css">
<script src="https://cdn.jsdelivr.net/npm/fullcalendar@5.10.1/main.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.18.1/moment.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fullcalendar@5.10.1/locales-all.js"></script>
<head th:replace="~{layout/header::head('Daily_Plan')}"></head>
<style>
   /* FullCalendar 화살표 색상 변경 */
   .fc .fc-button {
      color: white; /* 텍스트 색상을 흰색으로 변경 */
      background-color: #EAD8C0; /* 배경 색상을 파란색으로 변경 */
      border-color: #EAD8C0; /* 테두리 색상도 파란색으로 변경 */
   }

   .fc .fc-button-primary:not(:disabled).fc-button-active, .fc .fc-button-primary:disabled {
      background-color: #A79277; /* 활성화된 버튼의 배경 색상 설정 */
      border-color: #A79277; /* 활성화된 버튼의 테두리 색상 설정 */
   }

   .fc .fc-button-primary:hover {
      background-color: #795458; /* 호버 시 버튼의 배경 색상 설정 */
      border-color: #795458; /* 호버 시 버튼의 테두리 색상 설정 */
   }

</style>
<body>

   <div th:replace="~{layout/header::header}"></div>

   <div class="container">
      <div class="row">
         <div class="col-md-3">
            <ul class="nav flex-column">
               <li class="nav-item">
                  <a class="nav-link active" aria-current="page" href="#">달력</a>
               </li>
               <li class="nav-item">
                  <a class="nav-link" href="/">ToDoList</a>
               </li>
               <li class="nav-item">
                  <a class="nav-link" href="#">설정</a>
               </li>
               <li class="nav-item">
                  <a class="nav-link disabled" aria-disabled="true">행복한하루되세연</a>
               </li>
            </ul>
         </div>
         <div class="col-md-9">
            <div id='calendar'></div>
         </div>
      </div>
   </div>




   <script th:inline="javascript">
      document.addEventListener('DOMContentLoaded', function() {
         var calendarEl = document.getElementById('calendar');
         var calendar = new FullCalendar.Calendar(calendarEl, {
            initialView: 'dayGridMonth',
            headerToolbar: {
               left: 'prev,next today',
               center: 'title',
               right: 'dayGridMonth,timeGridWeek,timeGridDay'
            },
            locale: 'ko',
            events: function(fetchInfo, successCallback, failureCallback) {
               fetch('/layout/plan.do')
                       .then(response => response.json())
                       .then(data => {
                          var events = data.map(plan => ({
                             title: [plan.firstPlan, plan.secondPlan, plan.thirdPlan].filter(Boolean), // 이벤트 제목에 줄바꿈 포함
                             start: plan.startAt,
                             end: plan.endAt,
                             extendedProps: {
                                details: [plan.firstComment, plan.secondComment, plan.thirdComment].filter(Boolean), // 추가 세부 정보가 있다고 가정
                             }
                          }));
                          successCallback(events);
                       })
                       .catch(error => {
                          console.error('Error fetching events:', error);
                          failureCallback(error);
                       });
            },
                    eventClick: function(info) {
                       // 클릭 이벤트에서 모달 또는 툴팁으로 상세 정보 표시
                       var details = info.event.extendedProps.details || '없음'; // details가 undefined일 경우 대체 텍스트
                       alert('일정: ' + info.event.title + '\n세부내용: ' + details);
                    },
                    eventMouseEnter: function(info) {
                       // 마우스 오버 시 툴팁으로 간단한 정보 표시
                       var details = info.event.extendedProps.details || '없음'; // details가 undefined일 경우 대체 텍스트
                       $(info.el).tooltip({
                          title: `${info.event.title}<br>${details}`, // HTML로 렌더링
                          html: true,
                          placement: 'top',
                          trigger: 'hover'
                       }).tooltip('show');
                 },
            editable: true,
            selectable: true,
            droppable: true
         });

         calendar.render();
      });


   </script>


   
   
   <div th:replace="~{layout/footer::footer}"></div>
</body>
</html>
